"use strict";(self.webpackChunkscube_v4=self.webpackChunkscube_v4||[]).push([[822],{15822:(e,i,n)=>{n.r(i),n.d(i,{default:()=>z});var t=n(74848),l=n(96540),r=n(84425),a=(n(50513),n(65048),n(95093)),s=n.n(a),d=n(59408),o=n(77064),c=n(80771),u=n(20114),h=n(11848),f=n(58031),m=n(46831),v=n(22477),p=n(11641),x=n(5556),_=n.n(x),g=n(46775),j=function(){return j=Object.assign||function(e){for(var i,n=1,t=arguments.length;n<t;n++)for(var l in i=arguments[n])Object.prototype.hasOwnProperty.call(i,l)&&(e[l]=i[l]);return e},j.apply(this,arguments)},C=function(e){var i,n=e.params,l=e.handleRootChange,r=e.handleChildChange;return(0,t.jsx)("div",{children:null===(i=null==n?void 0:n.list)||void 0===i?void 0:i.map((function(e){var i,n;return(0,t.jsx)("div",{children:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",j({className:"flex gap-2 justify-between space-y-3"},{children:[(0,t.jsx)("div",{children:(0,t.jsx)("p",{children:(0,t.jsx)(g.A,{handleCheck:function(i){return l(i,e)},isChecked:null==e?void 0:e.is_checked,color:"text-yellow",name:null==e?void 0:e.name,Label:null==e?void 0:e.name})})}),(null===(i=e.children)||void 0===i?void 0:i.length)?(0,t.jsx)(t.Fragment,{}):(0,t.jsxs)("div",j({className:"flex gap-1"},{children:[(0,t.jsx)(g.A,{handleCheck:function(i){return l(i,e)},isChecked:null==e?void 0:e.is_write,color:"text-yellow",name:"is_write",Label:"C"}),(0,t.jsx)(g.A,{handleCheck:function(i){return l(i,e)},isChecked:e.is_read,color:"text-yellow",name:"is_read",Label:"R"}),(0,t.jsx)(g.A,{handleCheck:function(i){return l(i,e)},isChecked:null==e?void 0:e.is_update,color:"text-yellow",name:"is_update",Label:"U"}),(0,t.jsx)(g.A,{handleCheck:function(i){return l(i,e)},isChecked:null==e?void 0:e.is_delete,color:"text-yellow",name:"is_delete",Label:"D"})]}))]})),(0,t.jsx)("div",j({className:"flex gap-1 flex-col pl-6 lg:border-l-2 md:border-l-2 lg:border-[#141C4C] md:border-[#141C4C] lg:ml-[11px] md:ml-[11px] my-2"},{children:null===(n=null==e?void 0:e.children)||void 0===n?void 0:n.map((function(i){return(0,t.jsxs)("div",j({className:"mt-2 flex justify-between"},{children:[(0,t.jsx)(g.A,{isChecked:null==i?void 0:i.is_checked,color:"text-yellow",name:null==i?void 0:i.name,handleCheck:function(n){return r(n,e,i)},Label:null==i?void 0:i.name}),(0,t.jsxs)("div",j({className:"flex gap-1"},{children:[(0,t.jsx)(g.A,{handleCheck:function(n){return r(n,e,i)},isChecked:null==i?void 0:i.is_write,color:"text-yellow",name:"is_write",Label:"C"}),(0,t.jsx)(g.A,{handleCheck:function(n){return r(n,e,i)},isChecked:i.is_read,color:"text-yellow",name:"is_read",Label:"R"}),(0,t.jsx)(g.A,{handleCheck:function(n){return r(n,e,i)},isChecked:null==i?void 0:i.is_update,color:"text-yellow",name:"is_update",Label:"U"}),(0,t.jsx)(g.A,{handleCheck:function(n){return r(n,e,i)},isChecked:null==i?void 0:i.is_delete,color:"text-yellow",name:"is_delete",Label:"D"})]}))]}),i.id)}))}))]})},null==e?void 0:e.id)}))})};const b=C;C.propTypes={params:_().object.isRequired,handleRootChange:_().func.isRequired,handleChildChange:_().func.isRequired};var w=n(64746),k=n(80415),y=n(38693),A=n(93558),N=function(){return N=Object.assign||function(e){for(var i,n=1,t=arguments.length;n<t;n++)for(var l in i=arguments[n])Object.prototype.hasOwnProperty.call(i,l)&&(e[l]=i[l]);return e},N.apply(this,arguments)},R=(0,h.Ay)((function(e){return(0,t.jsx)(y.A,N({},e))}))((function(e){return{".MuiFormControlLabel-label":e.checked?{color:"#0C8EC7"}:{color:"#141C4C"}}})),S=function(e){var i=(0,w.A)(),n=!1;return i&&(n=i.value===e.value),(0,t.jsx)(R,N({checked:n},e))};const O=function(e){var i=e.items,n=e.name,r=e.onChange,a=e.checked,s=e.defaultValue,d=e.row;return(0,t.jsxs)("div",N({className:" w-full"},{children:[" ",(0,t.jsx)(k.A,N({name:n,defaultValue:s},{children:(0,t.jsxs)("div",N({className:"".concat(d?"flex":"")},{children:[" ",l.Children.toArray(i.map((function(e){return(0,t.jsx)(S,{value:null==e?void 0:e.value,label:null==e?void 0:e.label,control:(0,t.jsx)(A.A,{name:n,checked:a,onChange:r,sx:{"&:hover":{backgroundColor:"rgba(0, 133, 255, 0.1) "},color:"#141C4C","&.Mui-checked":{color:"#0C8EC7"}}})})})))]}))}))]}))};var L=n(30157),E=function(){return E=Object.assign||function(e){for(var i,n=1,t=arguments.length;n<t;n++)for(var l in i=arguments[n])Object.prototype.hasOwnProperty.call(i,l)&&(e[l]=i[l]);return e},E.apply(this,arguments)},M=(0,h.Ay)(f.A)((function(e){var i=e.theme;return{"& .MuiDialogContent-root":{padding:i.spacing(2),width:"100%",alignItems:"center"},"& .MuiDialogActions-root":{padding:i.spacing(1)},"& .css-1t1j96h-MuiPaper-root-MuiDialog-paper":{backgroundColor:"#404050"},dialogCustomizedWidth:{"max-width":"80%"}}})),I=function(e){var i=e.children,n=e.onClose,l=(e.type,function(e,i){var n={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&i.indexOf(t)<0&&(n[t]=e[t]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var l=0;for(t=Object.getOwnPropertySymbols(e);l<t.length;l++)i.indexOf(t[l])<0&&Object.prototype.propertyIsEnumerable.call(e,t[l])&&(n[t[l]]=e[t[l]])}return n}(e,["children","onClose","type"]));return(0,t.jsxs)(m.A,E({sx:{m:0,p:3}},l,{children:[i,(0,t.jsx)(p.A,E({"aria-label":"close",onClick:function(){n()},sx:{position:"absolute",right:8,top:8,color:function(e){return e.palette.grey[600]}}},{children:(0,t.jsx)("img",{src:"/assets/icons/closeIcon.svg",alt:""})}))]}))};const P=function(e){var i=e.open,n=e.handleClose,l=e.title,r=e.type,a=(e.name,e.submit),s=e.params,d=e.handleRootChange,o=e.handleChildChange,c=e.handleChange,h=e.formErrors,f=e.isApiLoading;return(0,t.jsx)("div",{children:(0,t.jsxs)(M,E({sx:{"& .MuiBackdrop-root":{backgroundColor:"rgba(0,0,0,0.8)",backdropFilter:"blur(5px)"}},"aria-labelledby":"customized-dialog-title",open:i,PaperProps:{sx:{width:"80%",m:0,backgroundColor:"arsenic",alignItems:"center",borderColor:"arsenic",borderRadius:"0px"}}},{children:[(0,t.jsx)(I,E({onClose:n,type:r},{children:(0,t.jsx)("div",E({className:"flex justify-start"},{children:(0,t.jsx)("p",E({className:"font-bold font-onestRegular flex justify-start absolute top-3 left-6"},{children:l}))}))})),(0,t.jsx)(v.A,{children:(0,t.jsx)("div",E({className:"flex flex-col mt-2 gap-10"},{children:(0,t.jsxs)("div",E({className:"w-full bg-lightshadedGray p-6 flex flex-col gap-6"},{children:[(0,t.jsx)(L.A,{rows:1,width:"w-full",disabled:!1,readOnly:!1,error:!!h.name,value:null==s?void 0:s.name,handleChange:c,helperText:h.name,label:"Enter the User Role*",name:"name"}),(0,t.jsx)("div",E({className:"default_container"},{children:(0,t.jsxs)("div",{children:[(0,t.jsx)("p",E({className:"text-s font-onestRegular mb-2"},{children:(0,t.jsx)("u",{children:"Select the level that user can Access:"})})),(0,t.jsx)(O,{onChange:c,items:[{value:"Manager",label:"Manager"},{value:"Executive",label:"Executive"}],defaultValue:s.role,name:"is_manager"})]})})),(0,t.jsxs)("div",E({className:"default_container"},{children:[(0,t.jsx)("div",E({className:"mb-2"},{children:(0,t.jsx)("p",E({className:"text-s font-onestRegular mb-2"},{children:(0,t.jsx)("u",{children:"Select the Module that user can Access:"})}))})),(0,t.jsx)(b,{params:s,handleRootChange:d,handleChildChange:o})]}))]}))}))}),(0,t.jsx)("div",E({className:"flex justify-center pt-2 pb-6"},{children:(0,t.jsx)(u.A,{loading:f,text:s.id?" Update Role ":"Submit Role",classes:"bg-darkBlue text-white text-black w-fit px-4  py-2",handleClick:a})}))]}))})};var D=n(56230),U=function(){return U=Object.assign||function(e){for(var i,n=1,t=arguments.length;n<t;n++)for(var l in i=arguments[n])Object.prototype.hasOwnProperty.call(i,l)&&(e[l]=i[l]);return e},U.apply(this,arguments)},F=function(e,i,n){if(n||2===arguments.length)for(var t,l=0,r=i.length;l<r;l++)!t&&l in i||(t||(t=Array.prototype.slice.call(i,0,l)),t[l]=i[l]);return e.concat(t||Array.prototype.slice.call(i))};const z=function(){var e=(0,l.useState)([]),i=e[0],n=e[1],a=(0,l.useState)([]),h=a[0],f=a[1],m=(0,l.useState)({}),v=m[0],p=m[1],x=(0,l.useState)(!1),_=x[0],g=x[1],j=(0,D.xC)(),C=[{headerName:"Role ID",field:"id"},{headerName:"Role Name",field:"name"},{headerName:"Total Users",field:"user_count"},{headerName:"Access Level",field:"is_manager",cellRenderer:function(e){return 1===e.value?"Manager":"Executive"}},{headerName:"Created On",field:"created_at",cellRenderer:function(e){return e.value?s()(null==e?void 0:e.value).utcOffset("+00:00").format("h:mm A, DD/M/yy"):"--"}},{headerName:"Actions",field:"status",cellRenderer:function(e){return(0,t.jsx)("div",U({className:"flex mt-1 items-center gap-3"},{children:(0,t.jsx)("button",U({onClick:function(){T(null==e?void 0:e.data)}},{children:(0,t.jsx)("img",{src:"/assets/icons/userEditIcon.svg",alt:"edit"})}))}))},suppressMenu:!0,sortable:!1,filter:!1}],b=(0,l.useState)(!1),w=b[0],k=b[1],y=(0,l.useState)({name:""}),A=y[0],N=y[1],R=(0,l.useState)({name:"",role:"Manager",id:"",is_manager:!1,list:[]}),S=R[0],O=R[1],L=(0,l.useState)(!1),E=L[0],M=L[1],I=function(){M(!0),d.S.get("roles?page=1&size=20").then((function(e){var i,n,t;f(null===(i=e.data.data)||void 0===i?void 0:i.data),O(U({},S)),p(null===(t=null===(n=null==e?void 0:e.data)||void 0===n?void 0:n.data)||void 0===t?void 0:t.pagination)})).catch((function(e){(0,c.Sx)(e.message,"error")})).finally((function(){M(!1)}))},z=function(e,i,n){e[i].is_checked=n,e[i].is_write=n,e[i].is_update=n,e[i].is_read=n,e[i].is_delete=n,e[i].children=e[i].children.map((function(e){return e.is_checked=n,e.is_write=n,e.is_update=n,e.is_read=n,e.is_delete=n,e}))},B=function(e,i,n,t){var l=e[i].children.findIndex((function(e){return e.id===t.id}));-1!=l&&(e[i].children[l].is_checked=n,e[i].children[l].is_write=n,e[i].children[l].is_update=n,e[i].children[l].is_read=n,e[i].children[l].is_delete=n);var r=e[i].children.some((function(e){return e.is_checked}));e[i].is_checked=r},T=function(e){var n=F([],i,!0);n=n.filter((function(e){return null==e.parent_id})).map((function(n){var t=e.permissions.find((function(e){return e.module_id===n.id}));return n.is_checked=(null==t?void 0:t.is_read)||(null==t?void 0:t.is_write)||(null==t?void 0:t.is_delete)||(null==t?void 0:t.is_update)||!1,n.is_read=(null==t?void 0:t.is_read)||!1,n.is_write=(null==t?void 0:t.is_write)||!1,n.is_delete=(null==t?void 0:t.is_delete)||!1,n.is_update=(null==t?void 0:t.is_update)||!1,n.children=i.filter((function(e){return e.parent_id===n.id})).map((function(i){var n=e.permissions.find((function(e){return e.module_id===i.id}));return i.is_checked=(null==n?void 0:n.is_read)||(null==n?void 0:n.is_write)||(null==n?void 0:n.is_delete)||(null==n?void 0:n.is_update)||!1,i.is_read=(null==n?void 0:n.is_read)||!1,i.is_write=(null==n?void 0:n.is_write)||!1,i.is_delete=(null==n?void 0:n.is_delete)||!1,i.is_update=(null==n?void 0:n.is_update)||!1,i})),n})),O(U(U({},S),{list:n,name:e.name,role:e.is_manager?"Manager":"Executive",id:e.id})),k(!0)},V=function(e,i){return e.push({module_id:i.id,is_read:i.is_read,is_write:i.is_write,is_update:i.is_update,is_delete:i.is_delete}),e};return(0,l.useEffect)((function(){I(),M(!0),d.S.get("roles/modules").then((function(e){var i;n(null===(i=null==e?void 0:e.data)||void 0===i?void 0:i.data)})).catch((function(e){(0,c.Sx)(e.message,"error")})).finally((function(){M(!1)}))}),[]),(0,t.jsxs)("div",U({className:""},{children:[(0,t.jsxs)("div",U({className:"flex  justify-between flex-col sm:flex-row"},{children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",U({className:"subheading"},{children:"Roles List"})),(0,t.jsx)("hr",{className:"w-32 md:w-full line"}),(0,t.jsxs)("p",U({className:"text-xs font-onestRegular mt-1 font-normal text-shadeDarkBlue"},{children:[null==v?void 0:v.total," Roles"]}))]}),(0,c.OQ)("roles","is_write")?(0,t.jsx)("div",U({className:"flex h-9 mt-4 lg:mt-0 gap-4"},{children:(0,t.jsx)(u.A,{loading:E,handleClick:function(){O(U(U({},S),{name:"",role:"Manager",id:"",is_manager:"Executive",list:[]}));var e=F([],i,!0);e=e.filter((function(e){return null==e.parent_id})).map((function(e){return e.is_checked=!1,e.is_write=!1,e.is_read=!1,e.is_delete=!1,e.is_update=!1,e.children=i.filter((function(i){return i.parent_id===e.id})).map((function(e){return e.is_read=!1,e.is_write=!1,e.is_delete=!1,e.is_update=!1,e.is_checked=!1,e})),e})),O(U(U({},S),{name:"",id:"",list:e,is_manager:!0,role:"Manager"})),k(!0)},text:"Create Role",icon:(0,t.jsx)("img",{src:"/assets/icons/plusIcon.svg",alt:"create"}),classes:"bg-darkshadeBlue text-white w-fit px-8   py-2"})})):(0,t.jsx)(t.Fragment,{})]})),(0,t.jsx)("div",U({className:"mt-6"},{children:(0,t.jsx)("div",U({className:"ag-theme-alpine",style:{height:"75vh"}},{children:(0,t.jsx)(r.AgGridReact,{gridOptions:{autoSizeStrategy:{type:"fitGridWidth",defaultMinWidth:100}},rowData:h,columnDefs:C,pagination:!0,onGridReady:function(e){j&&!(0,c.OQ)("roles","is_update")&&e.columnApi.setColumnsVisible(["status"],!1)},paginationPageSize:20,overlayNoRowsTemplate:'<span class="ag-overlay-loading-center">Loading...</span>'})}))})),(0,t.jsx)(P,{submit:function(){var e=(0,o.M)(S,{name:"required"});if("object"!=typeof e)if(/^[a-zA-Z0-9\s]+$/.test(S.name))if(S.list.some((function(e){return e.is_checked}))){for(var i,n=[],t=0,l=S.list;t<l.length;t++)if((i=l[t]).is_checked){n=V(n,i);var r=i.children.filter((function(e){return e.is_checked}));if(r.length)for(var a=0,s=r;a<s.length;a++){var u=s[a];n=V(n,u)}}var h={name:S.name,is_manager:"Executive"!=S.is_manager,permissions:n};g(!0),S.id?d.S.put("/roles/".concat(S.id),h).then((function(e){I(),k(!1),g(!1),(0,c.Sx)("ROLE UPDATED SUCCESSFULLY","success")})).catch((function(e){(0,c.Sx)(e.message,"error"),g(!1)})):d.S.post("roles",h).then((function(e){I(),k(!1),(0,c.Sx)("ROLE CREATED SUCCESSFULLY","success"),g(!1)})).catch((function(e){(0,c.Sx)(e.message,"error"),g(!1)}))}else(0,c.Sx)("Please Select least one module!","error");else N(U(U({},A),{name:"Invalid Role Name"}));else N(e)},handleClose:function(){k(!1)},handleRootChange:function(e,i){var n=e.target,t=n.name,l=n.checked,r=F([],S.list,!0),a=r.findIndex((function(e){return e.id==i.id}));if(-1!=a){if(l&&["is_write","is_update","is_read","is_delete"].includes(t)?(r[a].is_checked=l,r[a][t]=l):l&&z(r,a,l),!l&&["is_write","is_update","is_read","is_delete"].includes(t)){r[a][t]=l;var s=r[a];s.is_write||s.is_update||s.is_read||s.is_delete||(r[a].is_checked=l)}l||["is_write","is_update","is_read","is_delete"].includes(t)||z(r,a,l)}O(U(U({},S),{list:r}))},handleChildChange:function(e,i,n){var t=e.target,l=t.name,r=t.checked,a=F([],S.list,!0),s=a.findIndex((function(e){return e.id==i.id}));if(-1!=s){var d;if(r&&["is_write","is_update","is_read","is_delete"].includes(l)?(a[s].is_checked=r,-1!=(d=a[s].children.findIndex((function(e){return e.id===n.id})))&&(a[s].children[d].is_checked=r,a[s].children[d][l]=r)):r&&B(a,s,r,n),!r&&["is_write","is_update","is_read","is_delete"].includes(l)&&-1!=(d=a[s].children.findIndex((function(e){return e.id===n.id})))){a[s].children[d][l]=r;var o=a[s].children[d];o.is_write||o.is_update||o.is_read||o.is_delete||(a[s].children[d].is_checked=r);var c=a[s].children.some((function(e){return e.is_checked}));a[s].is_checked=c}r||["is_write","is_update","is_read","is_delete"].includes(l)||B(a,s,r,n)}O(U(U({},S),{list:a}))},handleChange:function(e){var i=U({},S);N("");var n=e.target,t=n.name,l=n.value;i[t]=l,O(i)},open:w,params:S,formErrors:A,isApiLoading:_,title:S.id?"Update User Role":"Add New User Role"})]}))}},46775:(e,i,n)=>{n.d(i,{A:()=>o});var t=n(74848),l=n(27558),r=n(59665),a=function(){return a=Object.assign||function(e){for(var i,n=1,t=arguments.length;n<t;n++)for(var l in i=arguments[n])Object.prototype.hasOwnProperty.call(i,l)&&(e[l]=i[l]);return e},a.apply(this,arguments)},s={inputProps:{"aria-label":"Checkbox demo"}},d=(0,r.A)((function(){return{root:{padding:0,"&:hover":{backgroundColor:"rgba(0, 133, 255, 0.1) !important"}}}}));const o=function(e){var i=e.defaultChecked,n=e.handleCheck,r=e.isChecked,o=e.Label,c=e.name,u=e.color,h=e.readonly,f=d();return(0,t.jsxs)("div",a({className:"flex items-center"},{children:[(0,t.jsx)(l.A,a({icon:(0,t.jsx)("svg",a({width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},{children:(0,t.jsx)("rect",{x:"0.75",y:"0.75",width:"18.5",height:"18.5",rx:"0",stroke:"#3C567E"})})),checkedIcon:(0,t.jsxs)("svg",a({xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20"},{children:[(0,t.jsx)("rect",{x:"0.75",y:"0.75",width:"20",height:"20",rx:"0",ry:"0",fill:"#1976d2"}),(0,t.jsx)("path",{fill:"#FFF",d:"M7 10l2 2 5-5 1.5 1.5-6.5 6.5-3.5-3.5 1-1z"})]})),sx:{"& .MuiSvgIcon-root":{fontSize:70,borderRadius:20}},disabled:h,name:c,id:o,checked:r,className:f.root,defaultValue:i},s,{onChange:n})),(0,t.jsx)("label",a({className:" ml-2  break-word sm:text-sm text-xs   ".concat(r?"text-WaterBlue":"".concat(u))},{children:o}))]}))}},77064:(e,i,n)=>{n.d(i,{M:()=>l});var t=n(29729),l=function(e,i,n){void 0===n&&(n={});var l=new t(e,i,n);if(l.fails()){var r={};for(var a in l.errors.errors)r[a]=l.errors.errors[a][0];return r}return!0}}}]);